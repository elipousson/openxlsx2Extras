[{"path":"https://elipousson.github.io/openxlsx2Extras/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 openxlsx2Extras authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Eli Pousson. Author, maintainer, copyright holder. Jan Marvin Garbuszus. Contributor.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pousson E (2025). openxlsx2Extras: Extra Functions openxlsx2 package. R package version 0.0.0.9000, https://github.com/elipousson/openxlsx2Extras.","code":"@Manual{,   title = {openxlsx2Extras: Extra Functions for the openxlsx2 package},   author = {Eli Pousson},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/elipousson/openxlsx2Extras}, }"},{"path":"https://elipousson.github.io/openxlsx2Extras/index.html","id":"openxlsx2extras","dir":"","previous_headings":"","what":"Extra Functions for the openxlsx2 package","title":"Extra Functions for the openxlsx2 package","text":"goal openxlsx2Extras extend functionality {openxlsx2} R package. package early stages expect things change break learn {openxlsx2} figure appropriate design package.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Extra Functions for the openxlsx2 package","text":"can install development version openxlsx2Extras like :","code":"pak::pkg_install(\"elipousson/openxlsx2Extras\")"},{"path":"https://elipousson.github.io/openxlsx2Extras/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Extra Functions for the openxlsx2 package","text":"December 2024, main types functions openxlsx2Extras include: Wrapper functions existing openxlsx2 functions add extra features, e.g. wb_save_ext() wraps openxlsx2::wb_save() Convenience functions multiple openxlsx2 convenience concise code, e.g. openxlsx2Extras::wb_new_workbook() combines openxlsx2::wb_workbook() openxlsx2::wb_add_worksheet() functions support Markdown formatted text (wb_add_marquee_text()), lists workbooks (map_wb()), lists data frames (wb_as_df_list()), coercion kinds objects spreadsheet-friendly formats (prep_wb_data()) example, wb_save_ext() allows users set filename based workbook title: wb_new_workbook() supports creating multiple worksheets single function call (recycling additional arguments like tab_color match length sheet_names):","code":"library(openxlsx2) library(openxlsx2Extras) wb <- wb_workbook(   title = \"Title used for output file\" )  wb <- wb$add_worksheet()  withr::with_tempdir({   wb_save_ext(wb)   fs::dir_ls() }) #> Title used for output file.xlsx wb_new_workbook(   title = \"Workbook created with wb_new_workbook\",   sheet_names = c(\"First sheet\", \"Second sheet\"),   tab_color = c(wb_color(\"orange\"), wb_color(\"yellow\")) ) #> A Workbook object. #>   #> Worksheets: #>  Sheets: First sheet, Second sheet  #>  Write order: 1, 2"},{"path":"https://elipousson.github.io/openxlsx2Extras/index.html","id":"related-projects","dir":"","previous_headings":"","what":"Related Projects","title":"Extra Functions for the openxlsx2 package","text":"Packages extending openxlsx tablexlsx ddotta/tablexlsx {a11ytables} co-analysis/a11ytables: generate best-practice stats spreadsheets publication {gtopenxlsx} yannsay/gtopenxlsx: tables xlsx format openxlsx Packages extending openxlsx2 flexlsx: pteridin/flexlsx add flextables Excel files {a11ytables2}: matt-dray/a11ytables2: generate best-practice stats spreadsheets publication Packages extending readxl forgts luisDVA/forgts}: reads spreadsheet formatting information produce gt tables cell text formatting input file. Packages working Microsoft Office files officer davidgohel/officer: office documents R {officerExtras} elipousson/officerExtras: R package {officer} helper functions.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_data_validation_value.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare a character vector as a data validation string — as_data_validation_value","title":"Prepare a character vector as a data validation string — as_data_validation_value","text":"as_data_validation_value() collapses character vector single string use validation value argument openxlsx2::wb_add_data_validation() type = \"list\".","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_data_validation_value.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare a character vector as a data validation string — as_data_validation_value","text":"","code":"as_data_validation_value(x, allow_blank = TRUE)"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_data_validation_value.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare a character vector as a data validation string — as_data_validation_value","text":"x character vector options allow cell validation. allow_blank TRUE, add blank space \" \" returned values.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_sheet_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare a data frame or list of data frames for inclusion in a workbook — as_sheet_list","title":"Prepare a data frame or list of data frames for inclusion in a workbook — as_sheet_list","text":"as_sheet_list() prepares list data frames inclusion workbook.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_sheet_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare a data frame or list of data frames for inclusion in a workbook — as_sheet_list","text":"","code":"as_sheet_list(   x,   sheet_names = NULL,   ...,   n_sheets = NULL,   .prep_fn = prep_wb_data,   repair = \"unique\",   default = \"Sheet\",   call = caller_env() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_sheet_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare a data frame or list of data frames for inclusion in a workbook — as_sheet_list","text":"sheet_names One sheet names. Empty values (\"\" \" \") replaced using default parameter value position sheet_names vector. ... Arguments passed prep_wb_data x Required. data frame object coercible data frame base::.data.frame(). list_columns String, one \"collapse\" (default), \"drop\", \"asis\" sep String use collapsing list columns. Ignored unless list_columns = \"collapse\". Defaults \"; \". geometry String, one \"drop\" (default), \"coords\", \"wkt\". \"coords\" uses sf::st_centroid() convert input POINT geometry, transforms geometry EPSG:4326, converts geometry coordinates, adds new columns names matching coords. \"wkt\" converts geometry Well Known Text (WKT) character vector using sf::st_as_text() replaces existing geometry column (keeping existing sf column name). coords Length 2 character vector column names add geometry = \"coords\". Must length 2 longitude, latitude order. call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information. n_sheets Number sheet names return. .prep_fn Function use preparing list input objects. Defaults prep_wb_data(). default Default prefix use numbered sheets. Default values used sheet_names = NULL n_sheets greater length sheet_names. Defaults \"Sheet\".","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_sheet_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare a data frame or list of data frames for inclusion in a workbook — as_sheet_list","text":"named list data frames.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_sheet_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare a data frame or list of data frames for inclusion in a workbook — as_sheet_list","text":"","code":"x <- head(mtcars, 1) y <- tail(mtcars, 1)  as_sheet_list(x) #> $`Sheet 1` #>           mpg cyl disp  hp drat   wt  qsec vs am gear carb #> Mazda RX4  21   6  160 110  3.9 2.62 16.46  0  1    4    4 #>   as_sheet_list(list(x, y)) #> $`Sheet 1` #>           mpg cyl disp  hp drat   wt  qsec vs am gear carb #> Mazda RX4  21   6  160 110  3.9 2.62 16.46  0  1    4    4 #>  #> $`Sheet 2` #>             mpg cyl disp  hp drat   wt qsec vs am gear carb #> Volvo 142E 21.4   4  121 109 4.11 2.78 18.6  1  1    4    2 #>   as_sheet_list(list(head = x, tail = y)) #> $head #>           mpg cyl disp  hp drat   wt  qsec vs am gear carb #> Mazda RX4  21   6  160 110  3.9 2.62 16.46  0  1    4    4 #>  #> $tail #>             mpg cyl disp  hp drat   wt qsec vs am gear carb #> Volvo 142E 21.4   4  121 109 4.11 2.78 18.6  1  1    4    2 #>   as_sheet_list(list(head = x, y)) #> $head #>           mpg cyl disp  hp drat   wt  qsec vs am gear carb #> Mazda RX4  21   6  160 110  3.9 2.62 16.46  0  1    4    4 #>  #> $`Sheet 2` #>             mpg cyl disp  hp drat   wt qsec vs am gear carb #> Volvo 142E 21.4   4  121 109 4.11 2.78 18.6  1  1    4    2 #>"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_wb.html","id":null,"dir":"Reference","previous_headings":"","what":"Coerce a data frame or list of data frames to a workbook — as_wb","title":"Coerce a data frame or list of data frames to a workbook — as_wb","text":"as_wb() converts data frame, list data frames, Excel file path wbWorkbook object.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_wb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coerce a data frame or list of data frames to a workbook — as_wb","text":"","code":"as_wb(   x,   ...,   sheet_names = NULL,   creator = NULL,   title = NULL,   subject = NULL,   category = NULL,   datetime_created = Sys.time(),   theme = NULL,   keywords = NULL,   properties = NULL,   call = caller_env() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_wb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coerce a data frame or list of data frames to a workbook — as_wb","text":"x data frame, list data frames, file path Excel file, wbWorkbook object. wbWorkbook returned \"\" ignoring parameters. file path loaded data frame using openxlsx2::wb_to_df(). ... Arguments passed wb_add_data_ext as_table Default FALSE. TRUE, use openxlsx2::wb_add_data_table() add data workbook. FALSE, use openxlsx2::wb_add_data(). Additional parameters ... passed one function depending value. labels Method handling column labels. \"drop\" (default) \"row_before\". \"row_before\", insert column labels row column names. list_columns String, one \"collapse\" (default), \"drop\", \"asis\" sep String use collapsing list columns. Ignored unless list_columns = \"collapse\". Defaults \"; \". geometry String, one \"drop\" (default), \"coords\", \"wkt\". \"coords\" uses sf::st_centroid() convert input POINT geometry, transforms geometry EPSG:4326, converts geometry coordinates, adds new columns names matching coords. \"wkt\" converts geometry Well Known Text (WKT) character vector using sf::st_as_text() replaces existing geometry column (keeping existing sf column name). coords Length 2 character vector column names add geometry = \"coords\". Must length 2 longitude, latitude order. wb Workbook object containing worksheet. sheet worksheet write . Can worksheet index name. start_row vector specifying starting row write x . sheet_names Optional character vector worksheet names. creator Creator workbook (name). Defaults login username options(\"openxlsx2.creator\") set. title, subject, category, keywords Additional arguments passed openxlsx2::wb_workbook(). datetime_created time workbook created theme Optional theme identified string number. See Details options. properties named list (typically openxlsx2::wb_get_properties()) used set new workbook properties values set NULL. datetime_created defaults Sys.time() must set NULL inherit value properties. call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information.","code":""},{"path":[]},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/as_wb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coerce a data frame or list of data frames to a workbook — as_wb","text":"","code":"as_wb(mtcars[1:3, ]) #> A Workbook object. #>   #> Worksheets: #>  Sheets: Sheet 1  #>  Write order: 1  as_wb(list(mtcars[1:3, ], mtcars[4:6, ])) #> A Workbook object. #>   #> Worksheets: #>  Sheets: Sheet 1, Sheet 2  #>  Write order: 1, 2"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/common_dxfs_styles.html","id":null,"dir":"Reference","previous_headings":"","what":"Common dxfs styles — common_dxfs_styles","title":"Common dxfs styles — common_dxfs_styles","text":"common_dxfs_styles named list dxfs styles created openxlsx2::create_dxfs_style() bad, good, neutral values.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/common_dxfs_styles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Common dxfs styles — common_dxfs_styles","text":"","code":"common_dxfs_styles"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/common_dxfs_styles.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Common dxfs styles — common_dxfs_styles","text":"object class list length 3.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/common_dxfs_styles.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Common dxfs styles — common_dxfs_styles","text":"https://stackoverflow.com/questions/27611260/---rgb-codes---conditional-formatting-styles--excel#comment78058968_27611522","code":""},{"path":[]},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/convert_to.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert CSV to XLSX files or XLSX to CSV — convert_to","title":"Convert CSV to XLSX files or XLSX to CSV — convert_to","text":"set functions convert CSV XLSX formats using flexible input output options.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/convert_to.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert CSV to XLSX files or XLSX to CSV — convert_to","text":"","code":"csv_to_wb(file, new_file = NULL, .f = utils::read.csv, ...)  csv_to_xlsx(file, new_file = NULL, .f = utils::read.csv, ...)  xlsx_to_csv(   file,   new_file = NULL,   sheet = 1,   .f = utils::write.csv,   ext = \"csv\",   ... )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/convert_to.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert CSV to XLSX files or XLSX to CSV — convert_to","text":"file Path paths input files. csv_to_wb(), users can pass multiple CSV files creating workbook xlsx file.  inputs named, names used worksheet names. new_file Path output file. Optional. new_file supplied file string, new_file set use path new file extension (file string) new_file set temporary file. .f Function used read write csv file. Defaults utils::read.csv csv_to_wb() csv_to_xlsx() utils::write.csv xlsx_to_csv(). functions allowed must use input output file name second argument. ... Additional arguments passed .f sheet sheet workbook specified file (either index sheet name). Defaults 1. ext File extension output file. Defaults \"csv\".","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/convert_to.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert CSV to XLSX files or XLSX to CSV — convert_to","text":"functions allow seamless conversion CSV XLSX formats: csv_to_wb: Reads one CSV files writes workbook object. csv_to_xlsx: Converts one CSV files XLSX file. xlsx_to_csv: Converts XLSX file CSV file.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/convert_to.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Convert CSV to XLSX files or XLSX to CSV — convert_to","text":"Jordan Mark Barbone jmbarbone@gmail.com Jan Marvin Garbuszus jan.garbuszus@ruhr-uni-bochum.de Eli Pousson eli.pousson@gmail.com","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/convert_to.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert CSV to XLSX files or XLSX to CSV — convert_to","text":"","code":"# Create example CSV file csv <- tempfile(fileext = \".csv\") utils::write.csv(x = mtcars, file = csv)  # Convert CSV to Workbook wb <- csv_to_wb(file = csv)  # Convert CSV to XLSX xlsx <- openxlsx2::temp_xlsx() csv_to_xlsx(file = csv, new_file = xlsx)  # Convert XLSX back to CSV xlsx_to_csv(file = xlsx, new_file = csv)"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/fmt_lgl_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Format logical vector columns to use replacement values — fmt_lgl_cols","title":"Format logical vector columns to use replacement values — fmt_lgl_cols","text":"fmt_lgl_cols() uses vec_fmt_lgl() format (specified) logical vector columns use replacement values.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/fmt_lgl_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format logical vector columns to use replacement values — fmt_lgl_cols","text":"","code":"fmt_lgl_cols(   .data,   .cols = tidyselect::where(is.logical),   values = c(\"Y\", \"N\") )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/fmt_lgl_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format logical vector columns to use replacement values — fmt_lgl_cols","text":".data data frame, data frame extension (e.g. tibble), lazy data frame (e.g. dbplyr dtplyr). See Methods, , details. .cols <tidy-select> Columns transform. select grouping columns already automatically handled verb (.e. summarise() mutate()). values Default c(\"Y\", \"N\") Length 2 vector first element replaces TRUE second element replaces FALSE.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/fmt_lgl_cols.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format logical vector columns to use replacement values — fmt_lgl_cols","text":"","code":"fmt_lgl_cols(data.frame(x = c(TRUE, FALSE, TRUE))) #>   x #> 1 Y #> 2 N #> 3 Y"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/fmt_marquee_txt.html","id":null,"dir":"Reference","previous_headings":"","what":"Use marquee::marquee_parse() to format Markdown text — fmt_marquee_txt","title":"Use marquee::marquee_parse() to format Markdown text — fmt_marquee_txt","text":"fmt_marquee_txt() uses marquee::marquee_parse() openxlsx2::fmt_txt() format Markdown text.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/fmt_marquee_txt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use marquee::marquee_parse() to format Markdown text — fmt_marquee_txt","text":"","code":"fmt_marquee_txt(   text,   ...,   style = marquee::classic_style(),   ignore_html = TRUE )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/fmt_marquee_txt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use marquee::marquee_parse() to format Markdown text — fmt_marquee_txt","text":"text character string. core quality markdown text valid markdown restrictions content ... Ignored time. future use. style style set classic_style() defines text rendered ignore_html HTML code removed output","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/fmt_marquee_txt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use marquee::marquee_parse() to format Markdown text — fmt_marquee_txt","text":"","code":"fmt_marquee_txt(   \"# ABC    abc\" ) #> [[1]] #> fmt_txt string:  #> [1] \"\" #>  #> [[2]] #> fmt_txt string:  #> [1] \"ABC\" #>  #> [[3]] #> fmt_txt string:  #> [1] \"abc\" #>"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/map_wb.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert an object to a list of workbooks — map_wb","title":"Convert an object to a list of workbooks — map_wb","text":"map_wb() takes list returns list wbWorkbook objects. properties recycled match length input x.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/map_wb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert an object to a list of workbooks — map_wb","text":"","code":"map_wb(x, ..., properties = NULL, .progress = FALSE)"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/map_wb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert an object to a list of workbooks — map_wb","text":"x data frame, list data frames, file path Excel file, wbWorkbook object. wbWorkbook returned \"\" ignoring parameters. file path loaded data frame using openxlsx2::wb_to_df(). ... Arguments passed as_wb sheet_names Optional character vector worksheet names. title,subject,category,keywords Additional arguments passed openxlsx2::wb_workbook(). creator Creator workbook (name). Defaults login username options(\"openxlsx2.creator\") set. datetime_created time workbook created theme Optional theme identified string number. See Details options. call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information. properties named list (typically openxlsx2::wb_get_properties()) used set new workbook properties values set NULL. datetime_created defaults Sys.time() must set NULL inherit value properties. .progress Whether show progress bar. Use TRUE turn basic progress bar, use string give name, see progress_bars details.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/map_wb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert an object to a list of workbooks — map_wb","text":"list wbWorkbook objects.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/map_wb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert an object to a list of workbooks — map_wb","text":"","code":"map_wb(list(mtcars[1:3, ], mtcars[4:6, ])) #> [[1]] #> A Workbook object. #>   #> Worksheets: #>  Sheets: Sheet 1  #>  Write order: 1 #> [[2]] #> A Workbook object. #>   #> Worksheets: #>  Sheets: Sheet 1  #>  Write order: 1"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/openxlsx2Extras-package.html","id":null,"dir":"Reference","previous_headings":"","what":"openxlsx2Extras: Extra Functions for the openxlsx2 package — openxlsx2Extras-package","title":"openxlsx2Extras: Extra Functions for the openxlsx2 package — openxlsx2Extras-package","text":"Extends openxlsx2 package wrapper helper functions designed add new features options working Excel workbooks.","code":""},{"path":[]},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/openxlsx2Extras-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"openxlsx2Extras: Extra Functions for the openxlsx2 package — openxlsx2Extras-package","text":"Maintainer: Eli Pousson eli.pousson@gmail.com (ORCID) [copyright holder] contributors: Jan Marvin Garbuszus jan.garbuszus@ruhr-uni-bochum.de [contributor]","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/prep_wb_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for adding to a workbook — prep_wb_data","title":"Prepare data for adding to a workbook — prep_wb_data","text":"prep_wb_data() prepares data frame addition workbook handling list columns geometry columns (sf data frames).","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/prep_wb_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for adding to a workbook — prep_wb_data","text":"","code":"prep_wb_data(   x,   list_columns = c(\"collapse\", \"drop\", \"asis\"),   sep = \"; \",   geometry = c(\"drop\", \"coords\", \"wkt\"),   coords = c(\"lon\", \"lat\"),   call = caller_env() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/prep_wb_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for adding to a workbook — prep_wb_data","text":"x Required. data frame object coercible data frame base::.data.frame(). list_columns String, one \"collapse\" (default), \"drop\", \"asis\" sep String use collapsing list columns. Ignored unless list_columns = \"collapse\". Defaults \"; \". geometry String, one \"drop\" (default), \"coords\", \"wkt\". \"coords\" uses sf::st_centroid() convert input POINT geometry, transforms geometry EPSG:4326, converts geometry coordinates, adds new columns names matching coords. \"wkt\" converts geometry Well Known Text (WKT) character vector using sf::st_as_text() replaces existing geometry column (keeping existing sf column name). coords Length 2 character vector column names add geometry = \"coords\". Must length 2 longitude, latitude order. call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/prep_wb_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare data for adding to a workbook — prep_wb_data","text":"","code":"list_df <- vctrs::data_frame(   num = 1,   alpha = list(list(\"A\", \"B\", \"C\")) )  prep_wb_data(list_df) #>   num   alpha #> 1   1 A; B; C  prep_wb_data(list_df, list_columns = \"drop\") #>   num #> 1   1  prep_wb_data(list_df, list_columns = \"asis\") #>   num               alpha #> 1   1 list(\"A\", \"B\", \"C\")  if (rlang::is_installed(\"sf\")) {   nc <- sf::read_sf(system.file(\"shape/nc.shp\", package = \"sf\"))    prep_wb_data(nc, geometry = \"coords\")    prep_wb_data(nc, geometry = \"wkt\") } #> # A tibble: 100 × 15 #>     AREA PERIMETER CNTY_ CNTY_ID NAME  FIPS  FIPSNO CRESS_ID BIR74 SID74 NWBIR74 #>    <dbl>     <dbl> <dbl>   <dbl> <chr> <chr>  <dbl>    <int> <dbl> <dbl>   <dbl> #>  1 0.114      1.44  1825    1825 Ashe  37009  37009        5  1091     1      10 #>  2 0.061      1.23  1827    1827 Alle… 37005  37005        3   487     0      10 #>  3 0.143      1.63  1828    1828 Surry 37171  37171       86  3188     5     208 #>  4 0.07       2.97  1831    1831 Curr… 37053  37053       27   508     1     123 #>  5 0.153      2.21  1832    1832 Nort… 37131  37131       66  1421     9    1066 #>  6 0.097      1.67  1833    1833 Hert… 37091  37091       46  1452     7     954 #>  7 0.062      1.55  1834    1834 Camd… 37029  37029       15   286     0     115 #>  8 0.091      1.28  1835    1835 Gates 37073  37073       37   420     0     254 #>  9 0.118      1.42  1836    1836 Warr… 37185  37185       93   968     4     748 #> 10 0.124      1.43  1837    1837 Stok… 37169  37169       85  1612     1     160 #> # ℹ 90 more rows #> # ℹ 4 more variables: BIR79 <dbl>, SID79 <dbl>, NWBIR79 <dbl>, geometry <chr>"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/read_xlsx_ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a data frame from a Workbook (with extra features) — read_xlsx_ext","title":"Create a data frame from a Workbook (with extra features) — read_xlsx_ext","text":"read_xlsx_ext() uses openxlsx2::read_xlsx() added features: allows use name repair argument (\"unique_quite\" default) avoid blank \"\" NA values column names. allows vector inputs file sheet argument. parameters recycled common length result return data frame list unless combine = TRUE set. combine = TRUE, set names_to (passed purrr::list_rbind) combined file basename values (default) full path values column (depending names_from argument). names_from can also length > 1 character vector can recycled match length file.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/read_xlsx_ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a data frame from a Workbook (with extra features) — read_xlsx_ext","text":"","code":"read_xlsx_ext(   file,   sheet = 1,   ...,   names_from = \"basename\",   names_to = rlang::zap(),   combine = TRUE,   repair = \"unique_quiet\" )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/read_xlsx_ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a data frame from a Workbook (with extra features) — read_xlsx_ext","text":"file xlsx file, wbWorkbook object URL xlsx file. sheet Defaults 1. ... Arguments passed openxlsx2::read_xlsx start_row first row begin looking data. start_col first column begin looking data. row_names TRUE, first col data used row names. col_names TRUE, first row data used column names. skip_empty_rows TRUE, empty rows skipped. skip_empty_cols TRUE, empty columns skipped. rows numeric vector specifying rows xlsx file read. NULL, rows read. cols numeric vector specifying columns xlsx file read. NULL, columns read. detect_dates TRUE, attempt recognize dates perform conversion. na.strings character vector strings interpreted NA. Blank cells returned NA. na.numbers numeric vector digits interpreted NA. Blank cells returned NA. fill_merged_cells TRUE, value merged cell given cells within merge. named_region Character string named_region (defined name table). sheet selected, first appearance selected. See wb_get_named_regions() check_names TRUE names variables data frame checked ensure syntactically valid variable names. show_hyperlinks TRUE instead displayed text, hyperlink targets shown. names_to default, names(x) lost. keep , supply string names_to names saved column name. names_to supplied x named, position elements used instead names. combine TRUE, always return data frames. FALSE, return list data frames. repair Either string function. string, must one \"check_unique\", \"minimal\", \"unique\", \"universal\", \"unique_quiet\", \"universal_quiet\". function, invoked vector minimal names must return minimal names, otherwise error thrown. Minimal names never NULL NA. element name, minimal name empty string. Unique names unique. suffix appended duplicate names make unique. Universal names unique syntactic, meaning can safely use names variables without causing syntax error. \"check_unique\" option perform name repair. Instead, error raised names suit \"unique\" criteria. options \"unique_quiet\" \"universal_quiet\" help user calls function indirectly, via another function exposes repair quiet. Specifying repair = \"unique_quiet\" like specifying repair = \"unique\", quiet = TRUE. \"*_quiet\" options used, setting quiet silently overridden.","code":""},{"path":[]},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/set_excel_fmt_class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare a data frame with Excel style class values for formatting by openxlsx2 — set_excel_fmt_class","text":"","code":"set_excel_fmt_class(   data,   cols,   fmt_class = \"currency\",   multiple = TRUE,   strict = FALSE )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/set_excel_fmt_class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare a data frame with Excel style class values for formatting by openxlsx2 — set_excel_fmt_class","text":"data data frame columns format. cols Column names numbers modify. fmt_class Excel style class, one : c(\"currency\", \"accounting\", \"hyperlink\", \"percentage\", \"scientific\", \"formula\"). Length recycled match length cols using vctrs::vec_recycle(). multiple Whether arg may contain zero several values. strict TRUE, error character values cols included names data. Default FALSE.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/set_excel_fmt_class.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare a data frame with Excel style class values for formatting by openxlsx2 — set_excel_fmt_class","text":"set_excel_fmt_class() applies style specified column. See openxlsx2 documentation information feature: https://janmarvin.github.io/openxlsx2/articles/openxlsx2_style_manual.html#numfmts2","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/set_sheet_list_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Set sheet names for input data — set_sheet_list_names","title":"Set sheet names for input data — set_sheet_list_names","text":"set_sheet_list_names() as_sheet_names() adapted existing functionality handling sheet names openxlsx2::write_xlsx().","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/set_sheet_list_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set sheet names for input data — set_sheet_list_names","text":"","code":"set_sheet_list_names(   x,   sheet_names = NULL,   ...,   n_sheets = NULL,   .prep_fn = prep_wb_data,   repair = \"unique\",   default = \"Sheet\",   call = caller_env() )  as_sheet_names(   sheet_names = NULL,   n_sheets = 1,   default = \"Sheet\",   max_length = 31,   excess_length = c(\"truncate\", \"error\"),   repair = \"unique\",   quiet = FALSE,   arg = caller_arg(sheet_names),   call = caller_env() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/set_sheet_list_names.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Set sheet names for input data — set_sheet_list_names","text":"https://github.com/JanMarvin/openxlsx2/blob/main/R/write_xlsx.R#L281-L301","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/set_sheet_list_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set sheet names for input data — set_sheet_list_names","text":"sheet_names One sheet names. Empty values (\"\" \" \") replaced using default parameter value position sheet_names vector. n_sheets Number sheet names return. default Default prefix use numbered sheets. Default values used sheet_names = NULL n_sheets greater length sheet_names. Defaults \"Sheet\". max_length Maximum allowed length characters sheet names. Must 31 less. excess_length Handling sheet names exceed max_length characters. \"truncate\" trims length max_length \"error\" errors.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/set_sheet_list_names.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set sheet names for input data — set_sheet_list_names","text":"","code":"as_sheet_names() #> [1] \"Sheet 1\"  as_sheet_names(\"Workbook sheet\") #> [1] \"Workbook sheet\"  as_sheet_names(c(\"Workbook sheet\", \"Workbook sheet\"), quiet = TRUE) #> [1] \"Workbook sheet...1\" \"Workbook sheet...2\"  as_sheet_names(\"Workbook sheet\", n_sheets = 2) #> [1] \"Workbook sheet\" \"Sheet 2\"         as_sheet_names(\"Sheet names longer than 31 characters are truncated\") #> ! Truncating `\"Sheet names longer than 31 characters are truncated\"` values to #>   31 characters. #> [1] \"Sheet names longer than 31 char\""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/vec_fmt_lgl.html","id":null,"dir":"Reference","previous_headings":"","what":"Format a logical vector to specified values — vec_fmt_lgl","title":"Format a logical vector to specified values — vec_fmt_lgl","text":"Format logical vector specified values","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/vec_fmt_lgl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format a logical vector to specified values — vec_fmt_lgl","text":"","code":"vec_fmt_lgl(x, values = c(\"Y\", \"N\"))"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/vec_fmt_lgl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format a logical vector to specified values — vec_fmt_lgl","text":"x logical vector. values Default c(\"Y\", \"N\") Length 2 vector first element replaces TRUE second element replaces FALSE.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/vec_fmt_lgl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format a logical vector to specified values — vec_fmt_lgl","text":"","code":"vec_fmt_lgl(c(TRUE, FALSE)) #> [1] \"Y\" \"N\"  vec_fmt_lgl(c(TRUE, FALSE), c(\"Yes\", \"No\")) #> [1] \"Yes\" \"No\""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_data_ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Add data using openxlsx2::wb_add_data() with extra features — wb_add_data_ext","title":"Add data using openxlsx2::wb_add_data() with extra features — wb_add_data_ext","text":"wb_add_data_ext() extends openxlsx2::wb_add_data() add data workbook special handling input data geometry list columns (using prep_wb_data()) labelled data.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_data_ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add data using openxlsx2::wb_add_data() with extra features — wb_add_data_ext","text":"","code":"wb_add_data_ext(   wb,   x,   sheet = current_sheet(),   ...,   start_row = 1,   list_columns = c(\"collapse\", \"drop\", \"asis\"),   sep = \"; \",   geometry = c(\"drop\", \"coords\", \"wkt\"),   coords = c(\"lon\", \"lat\"),   labels = c(\"drop\", \"row_before\"),   as_table = FALSE,   call = caller_env() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_data_ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add data using openxlsx2::wb_add_data() with extra features — wb_add_data_ext","text":"wb Workbook object containing worksheet. x Required. data frame object coercible data frame base::.data.frame(). sheet worksheet write . Can worksheet index name. ... Arguments passed openxlsx2::wb_add_data, openxlsx2::wb_add_data_table dims Spreadsheet cell range determine start_col start_row: \"A1\", \"A1:B2\", \":B\" start_col vector specifying starting column write x . array bool function written type array col_names TRUE, column names x written. row_names TRUE, row names x written. with_filter TRUE, add filters column name row. NOTE: can one filter per worksheet. name name named region specified. apply_cell_style write cell styles workbook remove_cell_style keep cell style? na.strings Value used replacing NA values x. Default looks options(openxlsx2.na.strings) set. Otherwise na_strings() uses special #N/value within workbook. inline_strings write characters inline strings enforce enforce selected dims filled. work, dims must match x table_style table style name \"none\" (see vignette(\"openxlsx2_style_manual\")) table_name Name table workbook. table name must unique. first_column logical. TRUE, first column bold. last_column logical. TRUE, last column bold. banded_rows logical. TRUE, rows color banded. banded_cols logical. TRUE, columns color banded. total_row logical. default FALSE total row added. start_row vector specifying starting row write x . list_columns String, one \"collapse\" (default), \"drop\", \"asis\" sep String use collapsing list columns. Ignored unless list_columns = \"collapse\". Defaults \"; \". geometry String, one \"drop\" (default), \"coords\", \"wkt\". \"coords\" uses sf::st_centroid() convert input POINT geometry, transforms geometry EPSG:4326, converts geometry coordinates, adds new columns names matching coords. \"wkt\" converts geometry Well Known Text (WKT) character vector using sf::st_as_text() replaces existing geometry column (keeping existing sf column name). coords Length 2 character vector column names add geometry = \"coords\". Must length 2 longitude, latitude order. labels Method handling column labels. \"drop\" (default) \"row_before\". \"row_before\", insert column labels row column names. as_table Default FALSE. TRUE, use openxlsx2::wb_add_data_table() add data workbook. FALSE, use openxlsx2::wb_add_data(). Additional parameters ... passed one function depending value. call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_data_ext.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add data using openxlsx2::wb_add_data() with extra features — wb_add_data_ext","text":"","code":"wb <- wb_new_workbook(\"mtcars\")  wb_add_data_ext(wb, mtcars) #> A Workbook object. #>   #> Worksheets: #>  Sheets: mtcars  #>  Write order: 1  wb_add_data_ext(wb, mtcars, as_table = TRUE) #> A Workbook object. #>   #> Worksheets: #>  Sheets: mtcars  #>  Write order: 1"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_marquee_text.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Markdown formatted text to a Workbook — wb_add_marquee_text","title":"Add Markdown formatted text to a Workbook — wb_add_marquee_text","text":"wb_add_marquee_text() uses fmt_marquee_txt() add Markdown formatted text Workbook. openxlsx2::wb_set_col_widths() applied workbook adjust widths specified columns. Set widths = NULL disable functionality.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_marquee_text.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Markdown formatted text to a Workbook — wb_add_marquee_text","text":"","code":"wb_add_marquee_text(   wb = NULL,   text,   sheet = current_sheet(),   dims = NULL,   ...,   cols = 1,   widths = \"auto\" )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_marquee_text.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Markdown formatted text to a Workbook — wb_add_marquee_text","text":"wb Workbook object containing worksheet. text character string. core quality markdown text valid markdown restrictions content sheet worksheet write . Can worksheet index name. dims Spreadsheet cell range determine start_col start_row: \"A1\", \"A1:B2\", \":B\" ... Arguments passed fmt_marquee_txt style style set classic_style() defines text rendered ignore_html HTML code removed output cols Indices cols set/remove column widths. widths Width set cols specified column width \"auto\" automatic sizing. widths recycled length cols. openxlsx2 sets default width 8.43, standard spreadsheet software. See Details general information column widths.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_marquee_text.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Markdown formatted text to a Workbook — wb_add_marquee_text","text":"","code":"library(openxlsx2)  wb <- wb_workbook() wb <- wb_add_worksheet(wb)  wb <- wb_add_marquee_text(   wb,   text = \" # Heading 1  Example text.  ~~Strikethrough text~~  ## Heading 2  - Bulleted list item 1   - Nested bullet - Bulleted list item 2\" )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_styles.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a named list of styles to a workbook — wb_add_styles","title":"Add a named list of styles to a workbook — wb_add_styles","text":"wb_add_styles() extends openxlsx2::wb_add_style() allowing addition multiple styles named list.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_styles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a named list of styles to a workbook — wb_add_styles","text":"","code":"wb_add_styles(wb, styles, style_names = NULL)"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_add_styles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a named list of styles to a workbook — wb_add_styles","text":"wb workbook styles Required. List style xml character, created ⁠create_*()⁠ function. Passed style argument openxlsx2::wb_add_style(). style_names Optional styles named list.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_dims_ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Extended helper to specify the dims or cols arguments — wb_dims_ext","title":"Extended helper to specify the dims or cols arguments — wb_dims_ext","text":"wb_dims_ext() extends openxlsx2::wb_dims() allowing workbook input used set x supporting tidy selection cols argument.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_dims_ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extended helper to specify the dims or cols arguments — wb_dims_ext","text":"","code":"wb_dims_ext(   wb = NULL,   sheet = openxlsx2::current_sheet(),   cols,   x = NULL,   select = NULL,   error_call = rlang::caller_env() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_dims_ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extended helper to specify the dims or cols arguments — wb_dims_ext","text":"select string, one followings. improves selection various parts x One \"x\", \"data\", \"col_names\", \"row_names\". \"data\" select data part, excluding row names column names  (default cols rows specified) \"x\" Includes data, column row names present. (default none rows cols provided) \"col_names\" return column names \"row_names\" return row names.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_new_workbook.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new workbook and add named work sheets — wb_new_workbook","title":"Create a new workbook and add named work sheets — wb_new_workbook","text":"wb_new_workbook() convenience function wrapping openxlsx2::wb_workbook() openxlsx2::wb_add_worksheet() offer quick easy setup new workbooks.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_new_workbook.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new workbook and add named work sheets — wb_new_workbook","text":"","code":"wb_new_workbook(   sheet_names = NULL,   ...,   default = \"Sheet\",   creator = NULL,   title = NULL,   subject = NULL,   category = NULL,   datetime_created = Sys.time(),   theme = NULL,   keywords = NULL,   properties = NULL,   call = caller_env() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_new_workbook.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new workbook and add named work sheets — wb_new_workbook","text":"sheet_names Optional character vector worksheet names. ... Arguments passed openxlsx2::wb_add_worksheet grid_lines logical. FALSE, worksheet grid lines hidden. row_col_headers logical. FALSE, worksheet colname rowname hidden. tab_color Color sheet tab.  wb_color(),  valid color (belonging grDevices::colors()) valid hex color beginning \"#\". zoom sheet zoom level, numeric 10 400 percentage. (zoom value smaller 10 default 10.) header,odd_header,even_header,first_header,footer,odd_footer,even_footer,first_footer Character vector length 3 corresponding positions left, center, right.  header footer used default additional arguments. Setting even, odd, first, overrides header/footer. Use NA skip position. visible FALSE, sheet hidden else visible. has_drawing TRUE prepare drawing output (TODO work?) paper_size integer corresponding paper size. See wb_page_setup() details. orientation One \"portrait\" \"landscape\" hdpi,vdpi Horizontal vertical DPI. Can set options(\"openxlsx2.dpi\" = X), options(\"openxlsx2.hdpi\" = X) options(\"openxlsx2.vdpi\" = X) default Default prefix use numbered sheets. Default values used sheet_names = NULL n_sheets greater length sheet_names. Defaults \"Sheet\". creator Creator workbook (name). Defaults login username options(\"openxlsx2.creator\") set. title, subject, category, keywords Additional arguments passed openxlsx2::wb_workbook(). datetime_created time workbook created theme Optional theme identified string number. See Details options. properties named list (typically openxlsx2::wb_get_properties()) used set new workbook properties values set NULL. datetime_created defaults Sys.time() must set NULL inherit value properties. call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_new_workbook.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new workbook and add named work sheets — wb_new_workbook","text":"wbWorkbook object.","code":""},{"path":[]},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_new_workbook.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a new workbook and add named work sheets — wb_new_workbook","text":"","code":"wb_new_workbook() #> A Workbook object. #>   #> Worksheets: #>  No worksheets attached  wb_new_workbook(\"Sheet 1\") #> A Workbook object. #>   #> Worksheets: #>  Sheets: Sheet 1  #>  Write order: 1  wb_new_workbook(c(\"Data\", \"Analysis\")) #> A Workbook object. #>   #> Worksheets: #>  Sheets: Data, Analysis  #>  Write order: 1, 2"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_save_ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Save a workboook object to file while filling file name from assigned workbook title — wb_save_ext","title":"Save a workboook object to file while filling file name from assigned workbook title — wb_save_ext","text":"wb_save_ext() helper function extending openxlsx2::wb_save() filling missing file name workbook title validating file extension. function stable may change future.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_save_ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save a workboook object to file while filling file name from assigned workbook title — wb_save_ext","text":"","code":"wb_save_ext(wb, file = NULL, overwrite = TRUE, ...)"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_save_ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save a workboook object to file while filling file name from assigned workbook title — wb_save_ext","text":"wb wbWorkbook object write file file path save workbook overwrite FALSE, overwrite file already exists. ... Arguments passed openxlsx2::wb_save path Deprecated argument. Please use file new code. flush Experimental, streams worksheet file disk","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_save_ext.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save a workboook object to file while filling file name from assigned workbook title — wb_save_ext","text":"","code":"withr::with_tempdir({   wb <- wb_new_workbook(     title = \"Title used for output file\",     sheet_name = \"Sheet 1\"   )    wb_save_ext(wb)    fs::dir_ls() }) #> Title used for output file.xlsx"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_set_col_widths_ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Set workbook column widths — wb_set_col_widths_ext","title":"Set workbook column widths — wb_set_col_widths_ext","text":"wb_set_col_widths_ext() extends openxlsx2::wb_set_col_widths() making cols optional (defaults columns) allows setting columns based column names (rather index position alone).","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_set_col_widths_ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set workbook column widths — wb_set_col_widths_ext","text":"","code":"wb_set_col_widths_ext(   wb,   cols = NULL,   widths = \"auto\",   sheet = current_sheet() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_set_col_widths_ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set workbook column widths — wb_set_col_widths_ext","text":"wb wbWorkbook object. cols Indices cols set/remove column widths. widths Width set cols specified column width \"auto\" automatic sizing. widths recycled length cols. openxlsx2 sets default width 8.43, standard spreadsheet software. See Details general information column widths. sheet name index worksheet, vector case remove_","code":""},{"path":[]},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_set_col_widths_ext.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set workbook column widths — wb_set_col_widths_ext","text":"","code":"wb <- as_wb(mtcars)  wb_set_col_widths_ext(wb, cols = \"drat\")  # `cols` is optional wb_set_col_widths_ext(wb)"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_set_properties_ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Set workbook properties — wb_set_properties_ext","title":"Set workbook properties — wb_set_properties_ext","text":"wb_set_properties_ext() extends openxlsx2::wb_set_properties() adding properties argument uses named list default default values existing properties.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_set_properties_ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set workbook properties — wb_set_properties_ext","text":"","code":"wb_set_properties_ext(   wb,   ...,   creator = NULL,   title = NULL,   subject = NULL,   category = NULL,   datetime_created = NULL,   datetime_modified = NULL,   modifier = NULL,   keywords = NULL,   comments = NULL,   manager = NULL,   company = NULL,   custom = NULL,   properties = NULL )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_set_properties_ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set workbook properties — wb_set_properties_ext","text":"wb Workbook object ... Must empty. creator Creator workbook (name). Defaults login username options(\"openxlsx2.creator\") set. title, subject, category, keywords, comments, manager, company Workbook property, string. datetime_created time workbook created datetime_modified time workbook last modified modifier character string indicating last person modify workbook custom named vector custom properties added workbook properties named character vector named list properties used default values parameter explicitly set.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_set_properties_ext.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set workbook properties — wb_set_properties_ext","text":"workbook modified properties.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_sheets_cols_to_dims.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a list of dimensions from one or more sheets — wb_sheets_cols_to_dims","title":"Get a list of dimensions from one or more sheets — wb_sheets_cols_to_dims","text":"wb_sheets_cols_to_dims() gets list dimension specifications based columns. Used get dimensions multiple column ranges across multiple sheets.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_sheets_cols_to_dims.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a list of dimensions from one or more sheets — wb_sheets_cols_to_dims","text":"","code":"wb_sheets_cols_to_dims(wb, cols, sheets = NULL)  wb_cols_to_index(wb, cols, sheet = current_sheet())  wb_cols_to_dims(wb, cols, sheet = current_sheet())"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_sheets_cols_to_dims.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a list of dimensions from one or more sheets — wb_sheets_cols_to_dims","text":"cols character vector list character vectors. Length cols recycled match length sheets. sheets Default use workbook sheets.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_sheets_fmt.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply formatting function that supports sheet and dims argument to one or more sheets — wb_sheets_fmt","title":"Apply formatting function that supports sheet and dims argument to one or more sheets — wb_sheets_fmt","text":"wb_sheets_fmt() applies formatting function one sheets columns. sheets recycled match length dims. dims can set based cols sheets set directly.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_sheets_fmt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply formatting function that supports sheet and dims argument to one or more sheets — wb_sheets_fmt","text":"","code":"wb_sheets_fmt(   wb,   .f = openxlsx2::wb_add_numfmt,   cols = NULL,   sheets = NULL,   dims = NULL,   ... )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_sheets_fmt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply formatting function that supports sheet and dims argument to one or more sheets — wb_sheets_fmt","text":".f Formatting function apply workbook. cols character vector list character vectors. Length cols recycled match length sheets. sheets Default use workbook sheets.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_split.html","id":null,"dir":"Reference","previous_headings":"","what":"Use dplyr::group_split to split a workbook into a list of workbooks — wb_split","title":"Use dplyr::group_split to split a workbook into a list of workbooks — wb_split","text":"wb_split() uses wb_to_df_list() extract data frames sheet workbook split data frames .key argument convert new list data frames back wbWorkbook object.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_split.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use dplyr::group_split to split a workbook into a list of workbooks — wb_split","text":"","code":"wb_split(   file,   .by,   ...,   .keep = TRUE,   properties = \"inherit\",   wb_params = list() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_split.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use dplyr::group_split to split a workbook into a list of workbooks — wb_split","text":"file xlsx file, wbWorkbook object URL xlsx file. .Passed dplyr::group_split(). ... Arguments passed wb_to_df_list sheet_names Character vector sheet names. supplied, sheet names supplied workbook used. .keep grouping columns kept? properties \"inherit\" (default) file workbook, inherit workbook list element properties existing workbook. properties can also NULL named character vector, named list, bare list length number groups defined using .argument. wb_params List additional parameters pass map_wb() as_wb().","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_split.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use dplyr::group_split to split a workbook into a list of workbooks — wb_split","text":"list wbWorkbook objects.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_split.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use dplyr::group_split to split a workbook into a list of workbooks — wb_split","text":"","code":"wb <- as_wb(list(mtcars[1:3, ], mtcars[4:6, ]))  wb_split(wb, .by = carb) #> $`1` #> A Workbook object. #>   #> Worksheets: #>  Sheets: Sheet 1, Sheet 2  #>  Write order: 1, 2 #> $`4` #> A Workbook object. #>   #> Worksheets: #>  Sheets: Sheet 1, Sheet 2  #>  Write order: 1, 2 #> $`2` #> A Workbook object. #>   #> Worksheets: #>  Sheets: Sheet 1, Sheet 2  #>  Write order: 1, 2"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_to_df_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a workbook to a list of data frames — wb_to_df_list","title":"Convert a workbook to a list of data frames — wb_to_df_list","text":"wb_to_df_list() uses openxlsx2::wb_to_df() extract sheet workbook object data frame. Additional parameters ... recycled match length sheet names.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_to_df_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a workbook to a list of data frames — wb_to_df_list","text":"","code":"wb_to_df_list(file, sheet_names = NULL, ...)"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_to_df_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a workbook to a list of data frames — wb_to_df_list","text":"file xlsx file, wbWorkbook object URL xlsx file. sheet_names Character vector sheet names. supplied, sheet names supplied workbook used. ... Arguments passed openxlsx2::wb_to_df sheet Either sheet name index. missing first sheet workbook selected. start_row first row begin looking data. start_col first column begin looking data. row_names TRUE, first col data used row names. col_names TRUE, first row data used column names. skip_empty_rows TRUE, empty rows skipped. skip_empty_cols TRUE, empty columns skipped. skip_hidden_rows TRUE, hidden rows skipped. skip_hidden_cols TRUE, hidden columns skipped. rows numeric vector specifying rows xlsx file read. NULL, rows read. cols numeric vector specifying columns xlsx file read. NULL, columns read. detect_dates TRUE, attempt recognize dates perform conversion. na.strings character vector strings interpreted NA. Blank cells returned NA. na.numbers numeric vector digits interpreted NA. Blank cells returned NA. fill_merged_cells TRUE, value merged cell given cells within merge. dims Character string type \"A1:B2\" optional dimensions imported. show_formula TRUE, underlying Excel formulas shown. convert TRUE, conversion dates numerics attempted. types named numeric indicating, type data. Names must match returned data. See Details . named_region Character string named_region (defined name table). sheet selected, first appearance selected. See wb_get_named_regions() keep_attributes TRUE additional attributes returned. (used internally define cell type.) check_names TRUE names variables data frame checked ensure syntactically valid variable names. show_hyperlinks TRUE instead displayed text, hyperlink targets shown.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_to_df_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a workbook to a list of data frames — wb_to_df_list","text":"list data frame lists.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/wb_to_df_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a workbook to a list of data frames — wb_to_df_list","text":"","code":"wb <- as_wb(list(mtcars[1:3, ], mtcars[4:6, ]))  wb_to_df_list(wb) #> $`Sheet 1` #>    mpg cyl disp  hp drat    wt  qsec vs am gear carb #> 2 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4 #> 3 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4 #> 4 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1 #>  #> $`Sheet 2` #>    mpg cyl disp  hp drat    wt  qsec vs am gear carb #> 2 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1 #> 3 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2 #> 4 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1 #>   wb_to_df_list(wb, \"Sheet 1\") #> $`Sheet 1` #>    mpg cyl disp  hp drat    wt  qsec vs am gear carb #> 2 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4 #> 3 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4 #> 4 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1 #>"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/write_xlsx_ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Write data to an xlsx file with additional features — write_xlsx_ext","title":"Write data to an xlsx file with additional features — write_xlsx_ext","text":"write_xlsx_ext() wraps wb_add_data_ext() provide equivalent openxlsx2::write_xlsx() additional features. Arguments passed openxlsx2::wb_workbook() ignored x workbook instead data frame.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/write_xlsx_ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write data to an xlsx file with additional features — write_xlsx_ext","text":"","code":"write_xlsx_ext(   x,   file = NULL,   ...,   sheet_names = NULL,   creator = NULL,   title = NULL,   subject = NULL,   category = NULL,   datetime_created = Sys.time(),   theme = NULL,   keywords = NULL,   as_table = FALSE,   start_row = 1,   geometry = \"drop\",   labels = \"drop\",   na.strings = na_strings(),   overwrite = TRUE,   call = caller_env() )"},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/write_xlsx_ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write data to an xlsx file with additional features — write_xlsx_ext","text":"x Required. wbWorkbook object, data frame, bare list data frames. x can also object coercible data frame (bare list) base::.data.frame(). x named list sheet_names supplied, existing names x ignored. file path save workbook ... additional arguments sheet_names Optional character vector worksheet names. creator Creator workbook (name). Defaults login username options(\"openxlsx2.creator\") set. title, subject, category, keywords Additional workbook properties passed wb_new_workbook(). Ignored (creator title) x workbook instead data frame. datetime_created time workbook created theme Optional theme identified string number. See Details options. as_table Default FALSE. TRUE, use openxlsx2::wb_add_data_table() add data workbook. FALSE, use openxlsx2::wb_add_data(). Additional parameters ... passed one function depending value. start_row vector specifying starting row write x . geometry String, one \"drop\" (default), \"coords\", \"wkt\". \"coords\" uses sf::st_centroid() convert input POINT geometry, transforms geometry EPSG:4326, converts geometry coordinates, adds new columns names matching coords. \"wkt\" converts geometry Well Known Text (WKT) character vector using sf::st_as_text() replaces existing geometry column (keeping existing sf column name). labels Method handling column labels. \"drop\" (default) \"row_before\". \"row_before\", insert column labels row column names. na.strings Used set temporary value openxlsx2.na.strings option. overwrite FALSE, overwrite file already exists. call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information.","code":""},{"path":"https://elipousson.github.io/openxlsx2Extras/reference/write_xlsx_ext.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write data to an xlsx file with additional features — write_xlsx_ext","text":"","code":"withr::with_tempdir({   # Write data frame to XLSX file   write_xlsx_ext(mtcars, \"mtcars.xlsx\")    # Write data frame to XLSX file with workbook title   write_xlsx_ext(mtcars, title = \"mtcars data\")    # Write list of data frames to XLSX file with named sheets   write_xlsx_ext(     list(mtcars = mtcars, anscombe = anscombe),     \"datasets-list.xlsx\"   )    # List output files   fs::dir_ls() }) #> datasets-list.xlsx mtcars data.xlsx   mtcars.xlsx"},{"path":"https://elipousson.github.io/openxlsx2Extras/news/index.html","id":"openxlsx2extras-0009000","dir":"Changelog","previous_headings":"","what":"openxlsx2Extras 0.0.0.9000","title":"openxlsx2Extras 0.0.0.9000","text":"Add set_sheet_list_names(), as_sheet_names(), as_sheet_list() utility functions (based existing openxlsx2 code). (2024-12-02) Add prep_wb_data() function (see #4, 2024-12-02). Add read_xlsx_ext(), write_xlsx_ext() (#3), wb_add_data_ext() functions (2024-11-10). Add set_excel_fmt_class() function. Add wb_add_marquee_text() fmt_marquee_txt() functions. Add wb_add_styles() function passing multiple styles list. Provide common_dxfs_styles prepared named list styles. (2025-01-25) Add as_data_validation_value() helper function. (2025-01-25) Publish package GitHub (2024-10-21).","code":""}]
